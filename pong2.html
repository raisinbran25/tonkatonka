<!DOCTYPE html>
<html>
  <head>
    <title>Pong Game</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="game-container">
      <div id="paddle-left"></div>
      <div id="paddle-right"></div>
      <div id="ball"></div>
      <div id="scoreboard">
        <div id="player1-score">0</div>
        <div id="player2-score">0</div>
      </div>
    </div>
    <script src="sqlite3.js"></script>
    <script>
      // Initialize SQLite database
      const db = new SQL.Database();
      db.run("CREATE TABLE IF NOT EXISTS scores (name TEXT, score INTEGER)");

      // Add new score to database
      const addScoreToDatabase = (name, score) => {
        const stmt = db.prepare("INSERT INTO scores (name, score) VALUES (?, ?)");
        stmt.run(name, score);
        stmt.free();
      };

      // Load scores from database and display in leaderboard
      const loadScores = () => {
        const results = db.exec("SELECT name, score FROM scores ORDER BY score DESC LIMIT 10");
        const leaderboardBody = document.getElementById("leaderboard-body");
        leaderboardBody.innerHTML = "";
        results[0].values.forEach((row) => {
          const name = row[0];
          const score = row[1];
          const newRow = document.createElement("tr");
          const nameCell = document.createElement("td");
          nameCell.textContent = name;
          const scoreCell = document.createElement("td");
          scoreCell.textContent = score;
          newRow.appendChild(nameCell);
          newRow.appendChild(scoreCell);
          leaderboardBody.appendChild(newRow);
        });
      };
      
      // Submit score to database and update leaderboard
      const submitScore = (event) => {
        event.preventDefault();
        const name = document.getElementById("name").value;
        const score = parseInt(document.getElementById("player1-score").textContent);
        addScoreToDatabase(name, score);
        loadScores();
        event.target.reset();
      };

      // Update player score and ball position on each frame
      const update = () => {
        // Update player scores
        const ball = document.getElementById("ball");
        if (ball.offsetLeft <= 0) {
          const player2Score = parseInt(document.getElementById("player2-score").textContent);
          document.getElementById("player2-score").textContent = player2Score + 1;
          ball.style.left = "245px";
          ball.style.top = "140px";
        } else if (ball.offsetLeft >= 490) {
          const player1Score = parseInt(document.getElementById("player1-score").textContent);
          document.getElementById("player1-score").textContent = player1Score + 1;
          ball.style.left = "245px";
          ball.style.top = "140px";
         }
      };
    </script>
  </body>
</html>
